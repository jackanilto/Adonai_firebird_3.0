unit UCartaRecomendação;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, RLReport;

type
  TFrmCartaApresentacao = class(TForm)
    RLReport1: TRLReport;
    RLBand1: TRLBand;
    imgLOGO: TRLImage;
    RLDBText1: TRLDBText;
    RLDBText2: TRLDBText;
    RLDBText3: TRLDBText;
    RLDBText4: TRLDBText;
    RLDBText5: TRLDBText;
    RLDBText6: TRLDBText;
    RLDBText7: TRLDBText;
    procedure RLBand1BeforePrint(Sender: TObject; var PrintIt: Boolean);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FrmCartaApresentacao: TFrmCartaApresentacao;

implementation

{$R *.dfm}

uses UDM, UDocumentos;

procedure TFrmCartaApresentacao.RLBand1BeforePrint(Sender: TObject; var PrintIt: Boolean);
var
  CaminhoImagem: string;
begin
  // Certifique-se de que o campo IMAGEM contém o caminho completo da imagem
  CaminhoImagem := DM.QueryIgrejasLOGO_CARTAS.AsString;

  if Trim(CaminhoImagem) <> '' then
  begin
    try
      // Tente carregar a imagem
      imgLOGO.Picture.LoadFromFile(CaminhoImagem);
    except
      on E: Exception do
      begin
        // Em caso de erro, exiba uma mensagem ou trate conforme necessário
        ShowMessage('Erro ao carregar a imagem: ' + E.Message);
      end;
    end;
  end
  else
  begin
    // Se o campo IMAGEM estiver vazio, talvez exiba uma imagem padrão ou trate conforme necessário
    imgLOGO.Picture := nil; // Isso pode ser substituído por uma imagem padrão, se desejar
  end;
end;

end.
